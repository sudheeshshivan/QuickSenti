@(title : String, pageId : Int, dataSources : List[ConfigurationInfoList])

<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>@title</title>
        <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
        <!-- bootstrap 3.0.2 -->
        <link rel="stylesheet" type="text/css" href="@routes.Assets.at("stylesheets/bootstrap.min.css")">
        <!-- font Awesome -->
        <link rel="stylesheet" type="text/css" href="@routes.Assets.at("stylesheets/font-awesome.min.css")">
        <!-- Ionicons -->
        <link rel="stylesheet" type="text/css" href="@routes.Assets.at("stylesheets/ionicons.min.css")">
        <!-- Theme style -->
        <link rel="stylesheet" type="text/css" href="@routes.Assets.at("stylesheets/AdminLTE.css")">

        <link rel="stylesheet" type="text/css" href="@routes.Assets.at("stylesheets/daterangepicker-bs3.css")">

        <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>
        <!-- jQuery UI 1.10.3 -->
        <script src="@routes.Assets.at("js/jquery-ui-1.10.3.min.js")" type="text/javascript"></script>

        
    </head>
    <body class="skin-black">
        <!-- header logo: style can be found in header.less -->
        <header class="header">
            <a href="#" class="logo">
                <!-- Add the class icon to your logo image or logo icon to add the margining -->
                Quick Senti
            </a>
            <!-- Header Navbar: style can be found in header.less -->
            <nav class="navbar navbar-static-top" role="navigation">
                <!-- Sidebar toggle button-->
                <a href="#" class="navbar-btn sidebar-toggle" data-toggle="offcanvas" role="button">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>
                <div class="navbar-right">
                    <ul class="nav navbar-nav">
                        <!-- Messages: style can be found in dropdown.less-->

                        <!-- User Account: style can be found in dropdown.less -->
                        <li class="dropdown user user-menu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="glyphicon glyphicon-user"></i>
                                <span>User<i class="caret"></i></span>
                            </a>
                            <ul class="dropdown-menu">
                                <!-- User image -->
                                <li class="user-header bg-light-blue">
                                    <img src="@routes.Assets.at("img/avatar3.png")" class="img-circle" alt="User Image" />
                                    <p>
                                        User
                                        <small>Member since Nov. 2012</small>
                                    </p>
                                </li>

                                <li class="user-footer">
                                    <div class="pull-left">
                                        <a href="#" class="btn btn-default btn-flat">Profile</a>
                                    </div>
                                    <div class="pull-right">
                                        <a href="@routes.Login.logout" class="btn btn-default btn-flat">Sign out</a>
                                    </div>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </nav>
        </header>
        <div class="wrapper row-offcanvas row-offcanvas-left">
            <!-- Left side column. contains the logo and sidebar -->
            <aside class="left-side sidebar-offcanvas">
                <!-- sidebar: style can be found in sidebar.less -->
                <section class="sidebar">
                    <!-- Sidebar user panel -->
                    <div class="user-panel">
                        <div class="pull-left image">
                            <img src="@routes.Assets.at("img/avatar3.png")" class="img-circle" alt="User Image" />
                        </div>
                        <div class="pull-left info">
                            <p>User</p>

                            <a href="#"><i class="fa fa-circle text-success"></i> Online</a>
                        </div>
                    </div>
                    
                    <ul class="sidebar-menu">
                        <li class="active">
                            <a href="@routes.UserArea.dashboard">
                                <i class="fa fa-home"></i> <span>Home</span>
                            </a>
                        </li>
                        <li>
                            <a href="@routes.Login.logout">
                                <i class="fa fa-sign-out"></i> <span>Logout</span>
                                <small class="badge pull-right bg-yellow"></small>
                            </a>
                        </li>
                        
                    </ul>
                </section>
            </aside>
            <aside class="right-side">

                <link rel="stylesheet" type="text/css" href="@routes.Assets.at("stylesheets/daterangepicker-bs3.css")">


                <section class="content-header">
                    <h1>
                        Report Page
                    </h1>
                </section>

                <section class="content">            
                                    
                    <div class="row">

                        <div class="col-md-12">
                            <div class="box">
                                <div class="box-header">
                                    <h3 class="box-title">Datasource Report Charts</h3>
                                </div><!-- /.box-header -->
                                <div class="box-body">
                                  <div class="row">

                                      <div class="col col-sm-4"> 

                                        <div class="form-group">
                                            <label>Select Datasource</label>
                                            <select class="form-control" id="datasource-field">
                                                @dataSources.map{ config =>
                                                  <option>@config.accountTitle</option>
                                                }
                                            </select>
                                        </div>
                                      </div>

                                      <div class="col col-sm-4">         
                                          <div class="form-group">
                                              <label>Select Date Range</label>
                                              <input type="text" class="form-control" id="datepicker">
                                          </div>
                                      </div>
                                      <div class="col col-sm-4">
                                            <div class="form-group">
                                                <label>Select Chart Type</label>
                                                <select class="form-control" id="chartType">
                                                    <option>line</option>
                                                    <option>bar</option>
                                                </select>
                                            </div>
                                      </div> 
                                
                                  </div>
                                </div><!-- /.box-body -->
                            </div><!-- /.box -->
                        </div>

                        <div class="col-md-12">
                            <div class="box">
                                <div class="box-header">
                                    <h3 class="box-title">Pie Chart</h3>
                                </div><!-- /.box-header -->
                                <div class="box-body">
                                  <div class="row">

                                      <div class="col col-sm-12">
                                          <canvas id="myChart3" width="300" height="150"></canvas>
                                      </div>
                                  </div>
                                </div><!-- /.box-body -->
                            </div><!-- /.box -->
                        </div>

                        <div class="col-md-12">
                            <div class="box">
                                <div class="box-header">
                                    <h3 class="box-title">Aggregate Sentiment</h3>
                                </div><!-- /.box-header -->
                                <div class="box-body">
                                  <div class="row">

                                      <div class="col col-sm-12">
                                          <canvas id="myChart" width="300" height="150"></canvas>
                                      </div>
                                  </div>
                                </div><!-- /.box-body -->
                            </div><!-- /.box -->
                        </div>

                        <div class="col-md-12">
                            <div class="box">
                                <div class="box-header">
                                    <h3 class="box-title">Seperate Sentiment</h3>
                                </div><!-- /.box-header -->
                                <div class="box-body">
                                  <div class="row">

                                      <div class="col col-sm-12">
                                          <canvas id="myChart2" width="300" height="150"></canvas>
                                      </div>
                                  </div>
                                </div><!-- /.box-body -->
                            </div><!-- /.box -->
                        </div>

                    </div>
                </section>

                <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>

                <script>

                function drawChart(trendsData) {

                  data = trendsData.trendData

                  var chartLabels = []
                  var chartValues = []

                  for (var i = data.length - 1; i >= 0; i--) {
                    chartLabels[i] = data[i].name;
                    // chartValues[i] = data[i].value * -1;
                    chartValues[i] = data[i].value;

                  }

                  console.log(chartLabels);
                  console.log(chartValues);

                  var chartTypeSelect = document.getElementById("chartType");
                  var chartType = chartTypeSelect.options[chartTypeSelect.selectedIndex].text;

                  console.log(chartType)

                  $('#myChart').replaceWith('<canvas id="myChart" width="400" height="150"></canvas>');

                  // document.getElementById("myChart").innerHTML = '<canvas id="myChart"></canvas>'

                  var ctx = document.getElementById("myChart").getContext('2d');

                  var myChart = new Chart(ctx, {
                      type: chartType,
                      data: {
                          labels: chartLabels,
                          datasets: [{
                              label: "Sentiment Value",
                              backgroundColor: '#5BC0EB',
                              borderColor: '#003459',
                              data: chartValues,
                          }]
                      },
                      options: {}
                  });

                  // -----------------------

                  console.log("data: "+trendsData)

                  allData = trendsData.allTrendData

                  var veryPositiveValues = []
                  var positiveValues = []
                  var neutralValues = []
                  var negativeValues = []
                  var veryNegativeValues = []

                  for (var i = allData.length - 1; i >= 0; i--) {

                    var val1 = allData[i]["Very positive"];

                    if (val1) {
                      veryPositiveValues[i] = val1
                    } else {
                      veryPositiveValues[i] = 0
                    }

                    var val2 = allData[i]["Positive"];

                    if (val2) {
                      positiveValues[i] = val2
                    } else {
                      positiveValues[i] = 0
                    }

                    var val3 = allData[i]["Neutral"];

                    if (val3) {
                      neutralValues[i] = val3
                    } else {
                      neutralValues[i] = 0
                    }

                    var val4 = allData[i]["Negative"];

                    if (val4) {
                      negativeValues[i] = val4
                    } else {
                      negativeValues[i] = 0
                    }

                    var val5 = allData[i]["Very negative"];

                    if (val5) {
                      veryNegativeValues[i] = val5
                    } else {
                      veryNegativeValues[i] = 0
                    }
                    
                  }

                  $('#myChart2').replaceWith('<canvas id="myChart2" width="400" height="150"></canvas>');

                  var ctx2 = document.getElementById("myChart2").getContext('2d');

                  var myChart = new Chart(ctx2, {
                      type: chartType,
                      data: {
                          labels: chartLabels,
                          datasets: [
                            {
                                label: "very Positive",
                                backgroundColor: '#248232',
                                borderColor: '#1E6B29',
                                data: veryPositiveValues,
                            },
                            {
                                label: "Positive",
                                backgroundColor: '#2BA84A',
                                borderColor: '#207B36',
                                data: positiveValues,
                            },
                            {
                                label: "Neutral",
                                backgroundColor: '#35A7FF',
                                borderColor: '#2C89D1',
                                data: neutralValues,
                            },
                            {
                                label: "Negative",
                                backgroundColor: '#941B0C',
                                borderColor: '#941B0C',
                                data: negativeValues,
                            },
                            {
                                label: "Very Negative",
                                backgroundColor: '#621708',
                                borderColor: '#511307',
                                data: veryNegativeValues,
                            }
                          ]
                      },
                      options: {}
                  });

                  function add(a, b) {
                      return a + b;
                  }

                  var veryPositiveSum = veryPositiveValues.reduce(add, 0);
                  var positiveSum = positiveValues.reduce(add, 0);
                  var neutralSum = neutralValues.reduce(add, 0);
                  var negativeSum = negativeValues.reduce(add, 0);
                  var veryNegativeSum = veryNegativeValues.reduce(add, 0);

                  $('#myChart3').replaceWith('<canvas id="myChart3" width="400" height="150"></canvas>');

                  var ctx3 = document.getElementById("myChart3").getContext('2d');

                  data = {
                      "datasets":[
                        {
                          "label":"My First Dataset",
                          "data":[veryPositiveSum,positiveSum,neutralSum,negativeSum,veryNegativeSum],
                          "backgroundColor":[
                            "rgb(255, 99, 132)",
                            "rgb(54, 162, 235)",
                            "rgb(255, 205, 86)",
                            "rgb(255, 39, 132)",
                            "rgb(255, 99, 32)"
                          ]
                        }
                      ],

                      "labels": [
                          'Very Positive',
                          'Positive',
                          'Neutral',
                          'Negative',
                          'Very Negative'
                      ]
                  };

                  var myPieChart = new Chart(ctx3,{
                      type: 'doughnut',
                      data: data,
                      options: {}
                  });

                }

                </script>

                <script type="text/javascript">
                $(function() {
                    $('input[id="datepicker"]').daterangepicker({
                    }, 
                    function(start, end, label) {
                        var startDate = start.format('YYYY-MM-DD');
                        var endDate = end.format('YYYY-MM-DD');
                        
                        if(startDate=="Start Date" || endDate =="End Date" || startDate=="" || endDate ==""){
                          $('#myChart').replaceWith('<canvas id="myChart" width="400" height="150"></canvas>');
                          alert("Select Two Dates");
                          return ;
                        }
                        if(startDate>endDate){
                            $('#myChart').replaceWith('<canvas id="myChart" width="400" height="150"></canvas>');
                            alert("Date Error");
                            return ;
                        }

                        var datasourceSelect = document.getElementById("datasource-field");
                        var datasource = datasourceSelect.options[datasourceSelect.selectedIndex].text;
                        
                        if (datasource != "iphone") {
                            $('#myChart').replaceWith('<canvas id="myChart" width="400" height="150"></canvas>');
                            alert("No data available for the selected datasource");
                            return;
                        }

                        $.ajax({url: '../adminArea/getTrendData/'+startDate+'/'+endDate, success: function(result){
                            console.log(result);
                            if(typeof result.trendData == 'undefined'){
                              $('#myChart').replaceWith('<canvas id="myChart" width="400" height="150"></canvas>');
                              alert(result);              
                            }
                            else {        
                              drawChart(result);      
                            }
                        }});
                    });
                });
                </script>
            </div>
        </aside>
        <!-- jQuery 2.0.2 -->

        <!-- Bootstrap -->
        <script src="@routes.Assets.at("js/bootstrap.min.js")" type="text/javascript"></script>
        <script src="@routes.Assets.at("js/plugins/daterangepicker/daterangepicker.js")" type="text/javascript"></script>

        <script src="@routes.Assets.at("js/AdminLTE/app.js")" type="text/javascript"></script>

    </body>
</html>